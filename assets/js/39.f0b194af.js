(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{365:function(s,n,a){"use strict";a.r(n);var t=a(4),e=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h3",{attrs:{id:"一、简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、简介"}},[s._v("#")]),s._v(" 一、简介")]),s._v(" "),n("p",[s._v("Dockerfile是一个文本文件，里面包含一条条指令，每一条指令就是一层镜像。")]),s._v(" "),n("p",[s._v("一般情况下，Dockerfile分为4个部分：")]),s._v(" "),n("ul",[n("li",[s._v("基础镜像")]),s._v(" "),n("li",[s._v("维护者信息")]),s._v(" "),n("li",[s._v("镜像操作指令")]),s._v(" "),n("li",[s._v("容器启动时执行命令")])]),s._v(" "),n("p",[s._v("其中FROM指令必须是开篇第一个非注释行，是必须存在的一个指令，后面所有的操作都是基于这个镜像的。后面的指令就是一些操作指令，指令的详情在后面介绍。最后是CMD指定，这个指令表示在容器运行是需要执行的命令。")]),s._v(" "),n("h3",{attrs:{id:"二、工作逻辑"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、工作逻辑"}},[s._v("#")]),s._v(" 二、工作逻辑")]),s._v(" "),n("p",[s._v("1、在一个自定义的目录下有Dockerfile文件；")]),s._v(" "),n("ul",[n("li",[s._v("命名首字母必须是大写；")]),s._v(" "),n("li",[s._v("引用的文件必须在当前的目录及其一下目录；")]),s._v(" "),n("li",[s._v("如果有些文件不需要被打包，可以将这些文件当前目录下隐藏文件（.dockeringore）中；")])]),s._v(" "),n("p",[s._v("2、在当前目录下执行docker build来进行打包成镜像，Dockerfile中的命令必须是docker支持的命令；")]),s._v(" "),n("p",[s._v("3、基于刚才打包的镜像启动容器；")]),s._v(" "),n("h3",{attrs:{id:"三、指令介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、指令介绍"}},[s._v("#")]),s._v(" 三、指令介绍")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、FROM\n\n格式：FROM 或FROM "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\n\n第一条指令必须为 FROM 指令，并且，如果在同一个 Dockerfile 中创建多个镜像时，可以使用多个 FROM 指令（每个镜像一次）\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、MAINTAINET\n\n格式：MAINTAINET\n\n指定维护者的信息\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、RUN\n\n格式：RUN或 RUN "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("“”, “”, “”"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n每条指令将在当前镜像基础上执行，并提交为新的镜像。（可以用 “"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("” 换行）\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("、CMD\n\n格式：CMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("“”,””,””"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n指定启动容器时执行的命令，每个 Dockerfile 只能有一条 CMD 指令，如果指定了多条指令，则最后一条执行。（会被启动时指定的命令覆盖）\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("、EXPOSE\n\n格式：EXPOSE "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" …"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n告诉 Docker 服务端暴露端口，在容器启动时需要通过 "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" 做端口映射\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("、ENV\n\n格式：ENV\n\n指定环境变量，会被 RUN 指令使用，并在容器运行时保存\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("、ADD\n\n格式：ADD\n\n复制指定的到容器的中，可以是 Dockerfile 所在的目录的一个相对路径；可以是 URL，也可以是 tar.gz（自动解压）\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("、COPY\n\n格式：COPY\n\n复制本地主机的 （ 为 Dockerfile 所在目录的相对路径）到容器中的 （当使用本地目录为源目录时，推荐使用 COPY）\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("、ENTRYPOINT\n\n格式：ENTRYPOINT "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("“”,””,””"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n配置容器启动后执行的命令，并且不可被 "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run 提供的参数覆盖。（每个 Dockerfile 中只能有一个 ENTRYPOINT ，当指定多个时，只有最后一个起效）\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("、VOLUME\n\n格式：VOLUME "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("“/mnt”"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n创建一个可以从本地主机或其他容器挂载的挂载点，一般用来存放数据库和需要保持的数据等\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("、"),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("\n\n格式："),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" daemon\n\n指定运行容器时的用户名或 "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v("，后续的 RUN 也会使用指定用户。\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("、WORKDIR\n\n格式：WORKDIR /path/to/workdir\n\n为后续的 RUN 、 CMD 、 ENTRYPOINT 指令配置工作目录。（可以使用多个 WORKDIR 指令，后续命令如果参数是相对路径， 则会基于之前命令指定的路径）\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v("、ONBUILD\n\n格式：ONBUILD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INSTRUCTION"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n配置当所创建的镜像作为其它新创建镜像的基础镜像时，所执行的操作指令\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);