(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{414:function(s,a,t){"use strict";t.r(a);var e=t(4),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"velero"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#velero"}},[s._v("#")]),s._v(" Velero")]),s._v(" "),a("p",[s._v("Velero 备份和恢复 Kubernetes 集群资源和持久卷的工具，将备份的信息在对象存储中")]),s._v(" "),a("p",[a("code",[s._v("Velero")]),s._v(" 目前包含以下特性：")]),s._v(" "),a("ul",[a("li",[s._v("支持 "),a("code",[s._v("Kubernetes")]),s._v(" 集群数据备份和恢复")]),s._v(" "),a("li",[s._v("支持复制当前 "),a("code",[s._v("Kubernetes")]),s._v(" 集群的资源到其它 "),a("code",[s._v("Kubernetes")]),s._v(" 集群")]),s._v(" "),a("li",[s._v("支持复制生产环境到开发以及测试环境")])]),s._v(" "),a("h2",{attrs:{id:"与etcd的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#与etcd的区别"}},[s._v("#")]),s._v(" 与etcd的区别")]),s._v(" "),a("p",[s._v("与 Etcd 备份相比，直接备份 "),a("code",[s._v("Etcd")]),s._v(" 是将集群的全部资源备份起来。而 "),a("code",[s._v("Velero")]),s._v(" 就是可以对 "),a("code",[s._v("Kubernetes")]),s._v(" 集群内对象级别进行备份。除了对 "),a("code",[s._v("Kubernetes")]),s._v(" 集群进行整体备份外，"),a("code",[s._v("Velero")]),s._v(" 还可以通过对 "),a("code",[s._v("Type")]),s._v("、"),a("code",[s._v("Namespace")]),s._v("、"),a("code",[s._v("Label")]),s._v(" 等对象进行分类备份或者恢复。")]),s._v(" "),a("blockquote",[a("p",[s._v("注意: 备份过程中创建的对象是不会被备份的。")])]),s._v(" "),a("h2",{attrs:{id:"velero命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#velero命令"}},[s._v("#")]),s._v(" velero命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ velero create backup NAME "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("flags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 剔除 namespace")]),s._v("\n--exclude-namespaces stringArray                  namespaces to exclude from the backup\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 剔除资源类型")]),s._v("\n--exclude-resources stringArray                   resources to exclude from the backup, formatted as resource.group, such as storageclasses.storage.k8s.io\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 包含集群资源类型 ")]),s._v("\n--include-cluster-resources optionalBool"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   include cluster-scoped resources "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the backup\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 包含 namespace")]),s._v("\n--include-namespaces stringArray                  namespaces to include "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the backup "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("use "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" all namespaces"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default *"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 包含 namespace 资源类型")]),s._v("\n--include-resources stringArray                   resources to include "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the backup, formatted as resource.group, such as storageclasses.storage.k8s.io "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("use "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" all resources"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给这个备份加上标签")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--labels")]),s._v(" mapStringString                          labels to apply to the backup\n-o, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--output")]),s._v(" string                               Output display format. For create commands, display the object but "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" not send it to the server. Valid formats are "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'table'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'json'")]),s._v(", and "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yaml'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'table'")]),s._v(" is not valid "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" command.\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对指定标签的资源进行备份")]),s._v("\n-l, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--selector")]),s._v(" labelSelector                      only back up resources matching this label selector "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对 PV 创建快照")]),s._v("\n--snapshot-volumes optionalBool"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("            take snapshots of PersistentVolumes as part of the backup\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定备份的位置")]),s._v("\n--storage-location string                         location "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" to store the backup\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备份数据多久删掉")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--ttl")]),s._v(" duration                                    how long before the backup can be garbage collected "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default 720h0m0s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定快照的位置，也就是哪一个公有云驱动")]),s._v("\n--volume-snapshot-locations strings               list of locations "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("at "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("most")]),s._v(" one per provider"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" where volume snapshots should be stored\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);